'use strict';window.tsfem_inpost=function(a){const b=tsfem_inpostL10n.post_ID,d=tsfem_inpostL10n.nonce,e=tsfem_inpostL10n.rlt,f=tsfem_inpostL10n.isPremium,g=tsfem_inpostL10n.locale,h=tsfem_inpostL10n.debug,i=tsfem_inpostL10n.i18n;let n={};const p=D=>{return n[D]?n[D]:void 0},q=D=>{n[D]&&n[D].terminate()},u=D=>{let E=D&&D.json||void 0,F=1===E;if(!F){let G=D;try{D=JSON.parse(D),F=!0}catch(H){F=!1,D=G}}return D};var v;const w=D=>{const E=(G,H)=>{let I=a(H),J=I.children('.tsfem-notice, .tsfem-notice-wrap .notice');1<J.length&&J.slice(0,J.length-1).each(function(){a(this).slideUp(200,function(){this.remove()})}),a(G).hide().appendTo(I).slideDown(200);let K=a('.tsfem-flex-settings-notification-area .tsfem-dismiss');const L=M=>{a(M.target).closest('.tsfem-notice').slideUp(200,function(){this.remove()})};K.off('click',L).on('click',L)},F=(G,H)=>{let I=a.Deferred(),J=H?1:0,K='';return a.ajax({method:'POST',url:ajaxurl,datatype:'json',data:{action:'tsfem_inpost_get_dismissible_notice',post_ID:b,nonce:d,'tsfem-notice-key':G,'tsfem-notice-has-msg':J},timeout:7e3,async:!0}).done(L=>{L=u(L),h&&console.log(L);let M=L&&L.data||void 0,N=L&&L.type||void 0;if(!M||!N||'undefined'==typeof M.notice);else{let O='';J?(O=a(M.notice),e?O.find('p').first().prepend(H+' '):O.find('p').first().append(' '+H)):O=M.notice,K=O}}).fail((L,M,N)=>{h&&(console.log(L.responseText),console.log(N));let O=J?wp.template('tsfem-inpost-notice-error'):wp.template('tsfem-inpost-notice-5xx'),P=O({code:G,msg:H});K=P}).always(()=>{I.resolve(K)}),I.promise()};return{in:G=>{if(D){if(v)return void setTimeout(()=>{w(D).in(G)},500);v=!0;let H=D.type||'error',I=D.code||void 0,J=D.text||'';if(void 0===I)F(-1,J).always(K=>{E(K,G),v=!1});else if(''===J)F(I,'').always(K=>{E(K,G),v=!1});else{let K=wp.template('tsfem-inpost-notice-'+H);D=K({code:I,msg:J}),E(D,G),v=!1}}}}},x=(D,E,F)=>{h&&(console.log(D.responseText),console.log(F));let G='';switch(F){case'abort':case'timeout':G=i.TimeoutError;break;case'Bad Request':G=i.BadRequest;break;case'Internal Server Error':G=i.FatalError;break;case'parsererror':G=i.ParseError;break;default:G=i.UnknownError;}return G},y=(D,E)=>{if(D instanceof NodeList)return void D.forEach(G=>y(G,E));if(D&&!(!D instanceof Element)){['edit','loading','unknown','error','bad','warning','okay','good'].forEach(G=>{D.classList.remove('tsfem-e-inpost-icon-'+G),G===E&&D.classList.add('tsfem-e-inpost-icon-'+G)})}};var z={},A={};const B=(D,E,F,G)=>{if(D&&!(!D instanceof HTMLElement)){D.style.willChange='opacity';let H=!1,I=!1;'function'==typeof F?(H=F,I=!0):'object'==typeof F&&(H='undefined'==typeof F.cb&&!1||F.cb,I='undefined'==typeof F.promise&&!0||F.promise),E=E||250,G=void 0===G||G;let M,J=0,K=0,L=10,N=D.dataset.tsfemFadeId||'_'+Math.random().toString(22).substr(2,10);D.dataset.tsfemFadeId=N,'undefined'!=typeof z[N]&&(clearInterval(z[N]),'undefined'!=typeof A[N]&&A[N].resolve()),I&&H&&(A[N]=a.Deferred(),(()=>{a.when(A[N]).done(()=>{delete A[N],H()})})(H)),G?(D.style.opacity=0,D.style.display=null,M=()=>{K=(J+=L)/100,D.style.opacity=K,1<=K&&(clearInterval(z[N]),setTimeout(()=>D.style.opacity=1,0),D.style.display=null,I?'undefined'!=typeof A[N]&&A[N].resolve():H&&H(),'none'===D.style.display&&(D.style.display=null),D.style.willChange='auto',delete D.dataset.tsfemFadeId)}):(J=100*D.style.opacity,M=()=>{K=(J-=L)/100,D.style.opacity=K,0>=K&&(clearInterval(z[N]),D.style.opacity=0,I?'undefined'!=typeof A[N]&&A[N].resolve():H&&H(),D.style.display='none',D.style.willChange='auto',delete D.dataset.tsfemFadeId)}),z[N]=setInterval(M,E*L/100)}};return a.extend(!0,{load:function(){}},{postID:b,nonce:d,isPremium:f,locale:g,debug:h,i18n:i},{isActionableElement:D=>{return!(!D instanceof HTMLElement)&&(D instanceof HTMLInputElement||D instanceof HTMLSelectElement||D instanceof HTMLLabelElement||D instanceof HTMLButtonElement||D instanceof HTMLTextAreaElement)},escapeStr:(D,E)=>{return D.length?E?D.replace(/[&<>]/g,F=>{return{'&':'&amp;','<':'&lt;','>':'&gt;'}[F]}):D.replace(/[&<>"']/g,F=>{return{'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#039;'}[F]}):''},promiseLoop:(D,E,F,G=2e3)=>{let H=a.Deferred(),I=D.length;if(!I)return H.resolve();const J=K=>{let L,M,N;G&&(M=setTimeout(()=>{clearTimeout(L),N=setTimeout(()=>{H.reject()},250)},G)),L=setTimeout(()=>{a.when(E(D[K])).done(()=>{if(G&&(clearTimeout(M),N)){if(K<I)return;clearTimeout(N)}++K===I?H.resolve():(J(K),L=null)}).fail(()=>{H.reject()})},F)};return J(0),H.promise()},spawnWorker:(D,E)=>{return n[E]=new Worker(D)},getWorker:p,stopWorker:q,despawnWorker:D=>{n[D]&&(q(D),delete n[D])},tellWorker:(D,E)=>{let F=a.Deferred();return setTimeout(()=>{let G=p(D);G||F.reject(),G.onmessage=H=>{return'error'in H.data?F.reject(H.data.error):F.resolve(H.data)},G.onerror=H=>{h&&console.log(H),F.reject()},G.postMessage(E)}),F.promise()},doAjax:(D,E,F)=>{let G,H=F.noticeArea,I=F.premium||!1;return I&&!f?void D.reject():void(h&&console.log(E),a.ajax(E).done(J=>{D.notify(),J=u(J),h&&console.log(J);let K=J&&J.data||void 0,L=J&&J.type||void 0;if(!K||!L)return D.reject(),void(G={type:'error',code:-1,text:i.InvalidResponse});let M=K.results&&K.results.code||void 0,N=K.results&&K.results.notice||void 0,O=K.results&&K.results.type||void 0;M&&O&&(G={type:O,code:M,text:N}),'success'===L&&'data'in K?D.resolve(K.data):D.reject(M)}).fail((J,K,L)=>{D.reject(),h&&(console.log(J.responseText),console.log(L)),G={type:'error',code:-1,text:x(J,K,L)}}).always(()=>{D.notify(),G&&w(G).in(H)}))},convertJSONResponse:u,setFlexNotice:w,getAjaxError:x,setIconClass:y,fadeOut:(D,E,F)=>{B(D,E,F,!1)},fadeIn:B})}(jQuery),jQuery(window.tsfem_inpost.load);
